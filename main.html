<!doctype html>
<html lang="cs">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Výpočet rozdílu časů</title>
    <style>
        body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; max-width: 720px; margin: 2rem auto; padding: 1rem; }
        label { display: block; margin: 0.5rem 0; }
        .controls { display: flex; gap: 0.5rem; margin-top: 0.5rem; }
        button { padding: 0.4rem 0.6rem; }
        #result { font-weight: 600; margin-top: 1rem; }
        .small { color: #555; font-size: 0.9rem; }
    </style>
</head>

<body>
    <h1>Výpočet délky práce</h1>

    <form id="timeForm">
        <label>Začátek: <input type="time" id="start" required></label>
        <label>Konec: <input type="time" id="end" required></label>
        <div class="controls">
            <button type="submit">Spočítej</button>
            <button type="button" id="clear">Vyčistit</button>
            <button type="button" id="copy" title="Kopírovat výsledek do schránky">Kopírovat</button>
        </div>
    </form>

    <p id="result" aria-live="polite"></p>

    <script type="module">
        import { computeDiff } from './src/timecalc.js';

        // Použijeme event listenery místo inline atributu
        document.getElementById('timeForm').addEventListener('submit', (e) => {
            e.preventDefault();
            const start = document.getElementById('start').value;
            const end = document.getElementById('end').value;

            if (!start || !end) {
                document.getElementById('result').textContent = 'Zadejte oba časy.';
                return;
            }

            try {
                const { minutes, pretty } = computeDiff(start, end);
                document.getElementById('result').textContent = `Rozdíl: ${minutes} minut (${pretty})`;
            } catch (err) {
                document.getElementById('result').textContent = 'Chybný vstup.';
            }
        });

        document.getElementById('clear').addEventListener('click', () => {
            document.getElementById('start').value = '';
            document.getElementById('end').value = '';
            document.getElementById('result').textContent = '';
        });

        document.getElementById('copy').addEventListener('click', async () => {
            const txt = document.getElementById('result').textContent;
            if (!txt) return;
            try {
                await navigator.clipboard.writeText(txt);
                // jednoduchá zpětná vazba
                alert('Výsledek zkopírován do schránky');
            } catch (err) {
                alert('Kopírování selhalo: ' + (err && err.message ? err.message : 'neznámá chyba'));
            }
        });
    </script>

</body>

</html>